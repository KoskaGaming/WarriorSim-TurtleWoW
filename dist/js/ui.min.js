const MAX_WORKERS=~~Math.min(8,(navigator.hardwareConcurrency||8)/2),WEB_DB_URL="https://database.turtle-wow.org/?";var SIM=SIM||{};SIM.UI={init:function(){this.variables(),this.events(),this.initLog(),this.loadSession(),this.loadWeapons("mainhand"),this.updateSidebar(),this.main.find(".js-import").hide(),this.main.find(".js-export").hide(),this.body.on("click",".wh-tooltip, .tablesorter-default a",function(e){e.preventDefault()})},variables:function(){this.body=$("body"),this.buffs=this.body.find("article.buffs"),this.fight=this.body.find("article.fight"),this.rotation=this.body.find("article.rotation"),this.talents=this.body.find("article.talents"),this.runes=this.body.find("article.runes"),this.filter=this.body.find("article.filter"),this.main=this.body.find("section.main"),this.sidebar=this.body.find("section.sidebar"),this.tcontainer=this.main.find(".table-container"),this.alerts=this.body.find(".alerts"),this.progress=this.main.find("progress")},events:function(){var e=this;e.sidebar.find(".js-settings").click(function(t){t.preventDefault(),$(this).toggleClass("active"),window.scrollTo(0,0),$("section.settings").css("min-height",e.body.outerHeight()+"px"),$("section.settings").toggleClass("active"),e.sidebar.find(".js-stats").removeClass("active"),e.sidebar.find(".js-profiles").removeClass("active"),$("section.stats").removeClass("active"),$("section.profiles").removeClass("active"),e.body.removeClass("sidebar-mobile-open")}),e.sidebar.find(".js-profiles").click(function(t){t.preventDefault(),$(this).toggleClass("active"),window.scrollTo(0,0),$("section.profiles").css("min-height",e.body.outerHeight()+"px"),$("section.profiles").toggleClass("active"),e.sidebar.find(".js-stats").removeClass("active"),e.sidebar.find(".js-settings").removeClass("active"),$("section.stats").removeClass("active"),$("section.settings").removeClass("active"),e.body.removeClass("sidebar-mobile-open"),SIM.PROFILES.buildProfiles()}),e.sidebar.find(".js-dps").click(function(t){t.preventDefault(),e.disableEditMode(),e.startLoading(),e.simulateDPS()}),e.sidebar.find(".js-weights").click(function(t){t.preventDefault(),e.disableEditMode(),e.startLoading(),e.simulateDPS("stats")}),e.sidebar.find(".js-stats").click(function(t){t.preventDefault(),$(this).toggleClass("active"),window.scrollTo(0,0),$("section.stats").css("min-height",e.body.outerHeight()+"px"),$("section.stats").toggleClass("active"),e.sidebar.find(".js-settings").removeClass("active"),e.sidebar.find(".js-profiles").removeClass("active"),$("section.settings").removeClass("active"),$("section.profiles").removeClass("active"),e.body.removeClass("sidebar-mobile-open")}),e.body.on("click",".js-table",function(t){t.preventDefault(),e.disableEditMode();const i=e.tcontainer.find("table.gear tbody tr");i.addClass("waiting"),e.tcontainer.find("table.gear tbody tr td:last-of-type").html(""),e.startLoading(),e.simulateDPS(i),e.sidebar.addClass("closed"),e.sidebar.find(".menu-button-container").removeClass("open"),window.innerWidth<960&&(e.sidebar.get(0).scrollTop=0),e.body.removeClass("sidebar-mobile-open")}),e.main.on("click",".js-enchant",function(t){t.preventDefault(),e.disableEditMode();const i=e.tcontainer.find("table.enchant tbody tr");i.addClass("waiting"),e.tcontainer.find("table.enchant tbody tr td:last-of-type").html(""),e.startLoading(),e.simulateDPS(i)}),e.main.on("click",".js-editmode",function(t){t.preventDefault(),$(this).toggleClass("active"),window.scrollTo(0,0),$(this).hasClass("active")?e.enableEditMode():e.disableEditMode()}),e.main.on("click",".js-export",function(t){t.preventDefault(),e.exportProfile()}),e.main.on("click",".js-import",function(t){t.preventDefault(),e.importProfile()}),e.main.find("nav li a").click(function(e){e.preventDefault(),e.stopPropagation()}),e.main.find("nav li p, nav li img").click(function(t){t.preventDefault(),t.stopPropagation();let i=$(this).parents("li");i.addClass("active"),i.siblings().removeClass("active");var s=i.data("type");let a=!1;s||(s=i.parents("[data-type]").data("type"),a=!0),e.main.find(".js-editmode").show(),e.main.find(".js-table").show(),e.main.find(".js-import").hide(),e.main.find(".js-export").hide(),"mainhand"==s||"offhand"==s||"twohand"==s?e.loadWeapons(s):"custom"==s?e.loadCustom():e.loadGear(s)}),e.tcontainer.on("click","table.gear td:not(.ppm)",function(t){t.preventDefault();var i=$(this).parents("table"),s=(i.data("type"),i.data("max")),a=$(this).parent();if(i.hasClass("editmode"))a.hasClass("hidden")?e.rowShowItem(a):e.rowHideItem(a);else{if(a.hasClass("active"))e.rowDisableItem(a);else i.find("tr.active").length>=s&&e.rowDisableItem(i.find("tr.active").last()),e.rowEnableItem(a);e.updateSession(),e.updateSidebar(),SIM.SETTINGS.buildSpells()}}),e.tcontainer.on("click","table.enchant td:not(.ppm)",function(t){t.preventDefault();var i=$(this).parents("table"),s=$(this).parent(),a=s.data("temp");if(i.hasClass("editmode"))s.hasClass("hidden")?e.rowShowEnchant(s):e.rowHideEnchant(s);else{if(s.hasClass("active"))e.rowDisableEnchant(s);else{let t=i.find('tr.active[data-temp="'+a+'"]').first();t.length&&e.rowDisableEnchant(t),e.rowEnableEnchant(s)}e.updateSession(),e.updateSidebar(),SIM.SETTINGS.buildSpells()}}),e.runes.on("click",".rune .icon",function(t){t.preventDefault();var i=$("nav").children("ul").children("li.active").data("type"),s=$(this).closest("tr[name]").attr("name"),a=$(this).parent().attr("data-id").toString();e.loadGear(s);var n=e.tcontainer.find($(`.runes[data-type="${s}"]`)),r=n.find($(`[data-id="${a}"]`));r.hasClass("active")?e.rowDisableRunes(r):(n.children("div").each(function(t,i){e.rowDisableRunes($(i))}),e.rowEnableRunes(r)),e.updateSession(),e.updateSidebar(),SIM.SETTINGS.buildSpells(),SIM.SETTINGS.buildBuffs(),"mainhand"==i||"offhand"==i||"twohand"==i?e.loadWeapons(i):"custom"==i?e.loadCustom():e.loadGear(i)}),e.tcontainer.on("click",".runes .icon",function(t){t.preventDefault();var i=$(this).parents(".runes"),s=$(this).parent();if(s.hasClass("active"))e.rowDisableRunes(s);else{let t=i.find(".rune.active").first();t.length&&e.rowDisableRunes(t),e.rowEnableRunes(s)}e.updateSession(),e.updateSidebar(),SIM.SETTINGS.buildSpells(),SIM.SETTINGS.buildBuffs()}),e.sidebar.find(".menu-button-container").click(function(t){t.preventDefault(),$(this).parents(".sidebar").toggleClass("closed"),$(this).parents(".sidebar").get(0).scrollTop=0,$(this).toggleClass("open"),e.body.toggleClass("sidebar-mobile-open")}),e.tcontainer.on("keyup",'input[name="search"]',function(t){t.preventDefault(),"Escape"==t.key&&$(this).val("");let i=$(this).val();e.tcontainer.find(".gear td:nth-child(2)").each(function(){let e=$(this).get(0);!i||e.textContent.toLowerCase().indexOf(i.toLowerCase())>-1?e.parentElement.classList.remove("filtered"):e.parentElement.classList.add("filtered")})}),e.tcontainer.on("click",".filters label",function(t){t.preventDefault(),t.stopPropagation(),$(this).toggleClass("active"),globalThis[$(this).attr("id")]=$(this).hasClass("active"),e.updateSession(),e.filterGear()})},enableEditMode:function(){let e=this.tcontainer.find("table.gear").attr("data-type");"mainhand"==e||"offhand"==e||"twohand"==e?this.loadWeapons(e,!0):"custom"==e?this.loadCustom(!0):this.loadGear(e,!0)},disableEditMode:function(){this.main.find(".js-editmode").removeClass("active");let e=this.tcontainer.find("table.gear").attr("data-type");"mainhand"==e||"offhand"==e||"twohand"==e?this.loadWeapons(e,!1):"custom"==e?this.loadCustom(!1):this.loadGear(e,!1)},simulateDPS:function(e){let t=this;if(e&&0==e.length)return void t.endLoading();console.clear();let i=t.sidebar.find(".dps"),s=t.sidebar.find("#dpserr"),a=t.sidebar.find("#stats"),n=t.sidebar.find("#time"),r=t.sidebar.find(".js-dps");t.sidebar.find("#weights-div").css("display","");let l="stats"===e;l&&(e=void 0),i.text(""),s.text(""),n.text("");const d={player:[void 0,void 0,void 0,Player.getConfig()],sim:Simulation.getConfig(),fullReport:!0};if(e){let t=e.parents("table").data("type");"finger"!=t&&"trinket"!=t&&"custom"!=t||(d.player=[null,t,void 0,Player.getConfig()])}if(player=new Player(...d.player),!player.mh)return t.addAlert("No weapon selected"),void t.endLoading();var o=new SimulationWorkerParallel(MAX_WORKERS,d=>{const h=d.totaldmg/d.totalduration;i.text(h.toFixed(2));const c=d.sumdps,f=d.sumdps2,u=d.iterations,p=(f-c*c/u)/(u-1)/u;s.text((1.96*Math.sqrt(p)).toFixed(2)),n.text((d.endtime-d.starttime)/1e3),a.html(d.mindps.toFixed(2)+" min&nbsp;&nbsp;&nbsp;&nbsp;"+d.maxdps.toFixed(2)+" max"),r.css("background",""),e?t.simulateRows(Array.from(e)):l?t.simulateWeights(player,h,p):t.endLoading(),SIM.STATS.initCharts(d),o=null,player=null},(e,t)=>{let s=parseInt(e/t.iterations*100);i.text((t.totaldmg/t.totalduration).toFixed(2)),r.css("background","linear-gradient(to right, transparent "+s+"%, #444 "+s+"%)")},e=>{i.text("ERROR"),console.error(e)});o.start(d)},simulateWeights:function(e,t,i){const s=this,a=s.sidebar.find(".js-weights"),n=e.auras.bloodfury?4:3;s.sidebar.find("#weights-div").css("display","block"),s.sidebar.find("#weights-div > div").addClass("loading").append('<span class="spinner"><span class="bounce1"></span><span class="bounce2"></span><span class="bounce3"></span></span>');let r=0;function l(e){const t=parseInt(100*(r+e)/n);a.css("background","linear-gradient(to right, transparent "+t+"%, #444 "+t+"%)")}const d=(e,s)=>this.simulateStat(e,s,l).then(e=>(r+=1,{weight:(e.mean-t)/s,error:1.96*Math.sqrt(i+e.varmean)/s}));function o(e,{weight:t,error:i}){const a=s.sidebar.find("#weight-"+e);a.removeClass("loading").find(".spinner").remove(),a.find(".stat-dps").text(t.toFixed(2)),a.find(".stat-error").text(i.toFixed(2))}(async function(){o("agi",await d(4,20)),o("str",await d(3,20)),o("ap",await d(0,40)),o("crit",await d(1,1)),o("hit",await d(2,1)),o("haste",await d(5,1.01)),o("arp",await d(6,100)),o("mhskill",await d(7,1)),o("ohskill",await d(8,1))})().then(()=>{a.css("background",""),s.endLoading()},e=>{a.css("background",""),s.sidebar.find(".dps").text("ERROR"),s.sidebar.find("#dpserr").text(""),s.endLoading(),console.error(e)})},simulateStat:function(e,t,i){return new Promise((s,a)=>{const n={player:[t,e,3,Player.getConfig()],sim:Simulation.getConfig()};new SimulationWorkerParallel(MAX_WORKERS,e=>{const t=e.totaldmg/e.totalduration,i=e.sumdps,a=e.sumdps2,n=e.iterations;s({mean:t,varmean:(a-i*i/n)/(n-1)/n})},(e,t)=>{i&&i(e/t.iterations,t.totaldmg/t.totalduration)},e=>a(e)).start(n)})},simulateRows:function(e){var t=this,i=t.sidebar.find(".js-table");const s=e.map(n=>{const r={perc:0};return r.run=(()=>{a.delete(r),this.simulateRow($(n),n=>{r.perc=n;const l=Math.floor(Array.from(s.values()).map(e=>e.perc).reduce((e,t)=>e+t,0)/e.length);if(100==l?(i.css("background",""),t.endLoading(),t.updateSession()):i.css("background","linear-gradient(to right, transparent "+l+"%, #444 "+l+"%)"),100==r.perc){const e=a.values().next().value;e&&e.run()}})}),r}),a=new Set(s);for(const e of s.slice(0,MAX_WORKERS))e.run()},simulateRow:function(e,t){var i=this,s=e.find("td:last-of-type"),a=e.parents("table").data("type"),n=e.data("id"),r=e.parents("table").hasClass("enchant"),l=1==e.data("temp"),d=parseFloat(i.sidebar.find(".dps").text());const o={player:[n,a,l?2:r?1:0,Player.getConfig()],sim:Simulation.getConfig()};var h=new SimulationWorker(l=>{let o=$("<span></span>"),c=l.totaldmg/l.totalduration,f=c-d;if(o.text(f.toFixed(2)),f>=0?o.addClass("p"):o.addClass("n"),s.text(c.toFixed(2)).append(o),i.tcontainer.find("table").each(function(){if("custom"==a)return;$(this).trigger("update");let e=[[$(this).find("th").length-1,1]];$(this).trigger("sorton",[e])}),e.removeClass("waiting"),t(100),h=null,r)for(let e of enchant[a])e.id==n&&(e.dps=c.toFixed(2));else for(let e of gear[a])e.id==n&&(e.dps=c.toFixed(2))},(e,i)=>{let a=Math.floor(e/i.iterations*100);a<100&&(t(a),s.text((i.totaldmg/i.totalduration).toFixed(2)))},e=>{s.text("ERROR"),console.error(e)});h.start(o)},rowDisableItem:function(e){var t=e.parents("table").data("type");e.removeClass("active");for(let i=0;i<gear[t].length;i++)gear[t][i].id==e.data("id")&&(gear[t][i].selected=!1)},rowEnableItem:function(e){var t=e.parents("table").data("type");e.addClass("active");for(let i=0;i<gear[t].length;i++)gear[t][i].id==e.data("id")?gear[t][i].selected=!0:"finger"!=t&&"trinket"!=t&&"custom"!=t&&(gear[t][i].selected=!1);if("twohand"==t){for(let e=0;e<gear.mainhand.length;e++)gear.mainhand[e].selected=!1;for(let e=0;e<gear.offhand.length;e++)gear.offhand[e].selected=!1;for(let e=0;e<enchant.mainhand.length;e++)enchant.mainhand[e].selected=!1;for(let e=0;e<enchant.offhand.length;e++)enchant.offhand[e].selected=!1}if("mainhand"==t||"offhand"==t){for(let e=0;e<gear.twohand.length;e++)gear.twohand[e].selected=!1;for(let e=0;e<enchant.twohand.length;e++)enchant.twohand[e].selected=!1}for(let t=0;t<spells.length;t++)!spells[t].item||spells[t].id!=e.data("id")||spells[t].timetoendactive||spells[t].timetostartactive||(219223==spells[t].id?spells[t].active=!0:spells[t].timetoendactive=!0)},rowHideItem:function(e){var t=e.parents("table").data("type");e.removeClass("active"),e.addClass("hidden"),e.find(".hide").html(eyesvghidden);for(let i=0;i<gear[t].length;i++)gear[t][i].id==e.data("id")&&(gear[t][i].hidden=!0,gear[t][i].selected=!1)},rowShowItem:function(e){var t=e.parents("table").data("type");e.removeClass("hidden"),e.find(".hide").html(eyesvg);for(let i=0;i<gear[t].length;i++)gear[t][i].id==e.data("id")&&(gear[t][i].hidden=!1)},rowDisableEnchant:function(e){var t=e.parents("table").data("type");e.removeClass("active");for(let i=0;i<enchant[t].length;i++)enchant[t][i].id==e.data("id")&&(enchant[t][i].selected=!1)},rowEnableEnchant:function(e){var t=e.parents("table").data("type");e.addClass("active");for(let i=0;i<enchant[t].length;i++)enchant[t][i].id==e.data("id")&&(enchant[t][i].selected=!0)},rowHideEnchant:function(e){var t=e.parents("table").data("type");e.removeClass("active"),e.addClass("hidden"),e.find(".hide").html(eyesvghidden);for(let i=0;i<enchant[t].length;i++)enchant[t][i].id==e.data("id")&&(enchant[t][i].hidden=!0,enchant[t][i].selected=!1)},rowShowEnchant:function(e){var t=e.parents("table").data("type");e.removeClass("hidden"),e.find(".hide").html(eyesvg);for(let i=0;i<enchant[t].length;i++)enchant[t][i].id==e.data("id")&&(enchant[t][i].hidden=!1)},rowDisableRunes:function(e){var t=e.parents(".runes").data("type");e.removeClass("active");for(let i=0;i<runes[t].length;i++)if(runes[t][i].id==e.data("id")&&(runes[t][i].selected=!1,runes[t][i].enable)){for(let e of spells)e.id==runes[t][i].enable&&(e.active=!1);for(let e of buffs)e.id==runes[t][i].enable&&(e.active=!1),2458==e.id&&runes[t][i].gladstance&&(e.active=!0)}var i=this.body.find("article.runes"),s=$(`tr[name="${t}"]`);i.find(s).find("div").removeClass("active")},rowEnableRunes:function(e){var t=e.parents(".runes").data("type");e.addClass("active");let i=0;for(let s=0;s<runes[t].length;s++)if(runes[t][s].id==e.data("id")){if(runes[t][s].selected=!0,runes[t][s].enable){for(let e of spells)e.id==runes[t][s].enable&&(e.active=!0);for(let e of buffs)e.id==runes[t][s].enable&&(e.active=!0),runes[t][s].buffgroup&&e.group==runes[t][s].buffgroup&&e.id!==runes[t][s].enable&&(e.active=!1)}i=runes[t][s].id}var s=this.body.find("article.runes"),a=$(`[data-id="${i}"]`);s.find(a).children("div").addClass("active")},startLoading:function(){let e=$(".js-dps, .js-weights, .js-table, .js-enchant");e.addClass("loading"),e.append('<span class="spinner"><span class="bounce1"></span><span class="bounce2"></span><span class="bounce3"></span></span>'),$("section.main nav").addClass("loading")},endLoading:function(){let e=$(".js-dps, .js-weights, .js-table, .js-enchant");e.removeClass("loading"),e.find(".spinner").remove(),$("section.main nav").removeClass("loading")},updateSidebar:function(){var e=new Player;let t=JSON.parse(localStorage[mode+(globalThis.profileid||0)]),i="&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;";if(this.updatePaperdoll(),!e.mh)return;this.sidebar.find("#str").text(e.stats.str),this.sidebar.find("#agi").text(e.stats.agi),this.sidebar.find("#ap").text(e.stats.ap),this.sidebar.find("#skill").html(e.stats["skill_"+e.mh.type]+" <small>MH</small>"+(e.oh?i+e.stats["skill_"+e.oh.type]+" <small>OH</small>":"")),this.sidebar.find("#hit").html((e.stats.hit||0)+"%"),this.sidebar.find("#miss").html(Math.max(e.mh.miss,0).toFixed(2)+"% <small>"+(e.oh?"Abilities":"MH")+"</small>"+(e.oh?i+Math.max(e.mh.dwmiss,0).toFixed(2)+"% <small>Autos</small>":"")),this.sidebar.find("#dodge").html(e.mh.dodge.toFixed(2)+"% <small>MH</small>"+(e.oh?i+e.oh.dodge.toFixed(2)+"% <small>OH</small>":""));let s=e.mh.effectivecrit,a=e.oh?e.oh.effectivecrit:0;this.sidebar.find("#crit").html(s.toFixed(2)+"% <small>MH</small>"+(e.oh?i+a.toFixed(2)+"% <small>OH</small>":""));let n=Math.max(0,100-e.mh.dwmiss-e.mh.dodge-e.mh.glanceChance),r=Math.max(0,e.oh?100-e.oh.dwmiss-e.oh.dodge-e.oh.glanceChance:0);this.sidebar.find("#critcap").html(n.toFixed(2)+"% <small>MH</small>"+(e.oh?i+r.toFixed(2)+"% <small>OH</small>":""));let l=e.stats.dmgmod*e.mh.modifier*100,d=e.stats.dmgmod*(e.oh?100*e.oh.modifier:0);this.sidebar.find("#dmgmod").html(l.toFixed(2)+"% <small>MH</small>"+(e.oh?i+d.toFixed(2)+"% <small>OH</small>":"")),this.sidebar.find("#arp").html(e.stats.arp+"/"+e.target.basearmorbuffed+" <small>ArP</small>"+i+"+"+(100*e.arpContribution).toFixed(2)+"% <small>DPS</small>"),this.sidebar.find("#haste").html((100*e.stats.haste).toFixed(2)+"%"),this.sidebar.find("#shadow-resist").html(e.stats.resist.shadow),this.sidebar.find("#arcane-resist").html(e.stats.resist.arcane),this.sidebar.find("#nature-resist").html(e.stats.resist.nature),this.sidebar.find("#fire-resist").html(e.stats.resist.fire),this.sidebar.find("#frost-resist").html(e.stats.resist.frost),this.sidebar.find("#race").text(t.race),this.sidebar.find("#level").text(t.level),this.sidebar.find("#sets").empty();for(let t of sets){let i=0;for(let s of t.items)e.items.includes(s)&&i++;0!=i&&(i>=t.bonus[0].count&&this.sidebar.find("#sets").append(`<a href="${WEB_DB_URL}item-set=${t.id}" class="q4">${t.name} (${i})</a><br />`))}let o=0;for(let e of talents)for(let t of e.t)o+=t.c;this.talents.find("#points").text(Math.max(e.level-9-o,0))},updatePaperdoll:function(){let e={mainhand:"inventoryslot_mainhand",offhand:"inventoryslot_offhand",twohand:"inventoryslot_mainhand",ranged:"inventoryslot_ranged",head:"inventoryslot_head",neck:"inventoryslot_neck",shoulder:"inventoryslot_shoulder",back:"inventoryslot_chest",chest:"inventoryslot_chest",wrist:"inventoryslot_wrists",hands:"inventoryslot_hands",waist:"inventoryslot_waist",legs:"inventoryslot_legs",feet:"inventoryslot_feet",finger1:"inventoryslot_finger",finger2:"inventoryslot_finger",trinket1:"inventoryslot_trinket",trinket2:"inventoryslot_trinket"};for(let t in gear){let i,s=e[t],a="#",n=!0;if(enchant[t])for(let e of enchant[t])e.selected&&e.ench&&(i=e.ench);for(let e of gear[t])if(e.selected){s=e.p;let t=e.id.toString().split("|");a=t[0],23000399==e.id&&(a="230003"),22839799==e.id&&(a="228397"),22835099==e.id&&(a="228350"),23024299==e.id&&(a="230242"),i&&(a+="?ench="+i),2==t.length&&(a+=(i?"&":"?")+"rand="+t[1]),n=!1}$(`nav.paperdoll [data-type="${t}"]`).toggleClass("empty",n),$(`nav.paperdoll [data-type="${t}"] a`).attr("href",`${WEB_DB_URL}item=${a}`),$(`nav.paperdoll [data-type="${t}"] img`).attr("src",`https://wow.zamimg.com/images/wow/icons/medium/${s}.jpg`)}},updateSession:function(e){let t={};t.level=this.fight.find('input[name="level"]').val(),t.race=this.fight.find('select[name="race"]').val(),t.simulations=this.fight.find('input[name="simulations"]').val(),t.timesecsmin=this.fight.find('input[name="timesecsmin"]').val(),t.timesecsmax=this.fight.find('input[name="timesecsmax"]').val(),t.executeperc=this.fight.find('input[name="executeperc"]').val(),t.startrage=this.fight.find('input[name="startrage"]').val(),t.targetlevel=this.fight.find('input[name="targetlevel"]').val(),t.targetbasearmor=this.fight.find('select[name="targetbasearmor"]').val(),t.targetcustomarmor=this.fight.find('input[name="targetcustomarmor"]').val(),t.targetresistance=this.fight.find('input[name="targetresistance"]').val(),t.targetspeed=this.fight.find('input[name="targetspeed"]').val(),t.targetmindmg=this.fight.find('input[name="targetmindmg"]').val(),t.targetmaxdmg=this.fight.find('input[name="targetmaxdmg"]').val(),t.adjacent=this.fight.find('input[name="adjacent"]').val(),t.aqbooks=this.fight.find('select[name="aqbooks"]').val(),t.reactionmin=this.fight.find('input[name="reactionmin"]').val(),t.reactionmax=this.fight.find('input[name="reactionmax"]').val(),t.batching=this.fight.find('select[name="batching"]').val(),t.filter_strength=this.main.find("#filter_strength").hasClass("active"),t.filter_timeworn=this.main.find("#filter_timeworn").hasClass("active"),t.filter_bear=this.main.find("#filter_bear").hasClass("active"),t.filter_tiger=this.main.find("#filter_tiger").hasClass("active"),t.filter_green=this.main.find("#filter_green").hasClass("active"),t.filter_blue=this.main.find("#filter_blue").hasClass("active"),t.filter_epic=this.main.find("#filter_epic").hasClass("active"),t.bleedreduction=this.fight.find('select[name="bleedreduction"]').val(),t.spellqueueing=this.fight.find('select[name="spellqueueing"]').val();let i=[],s=[],a=[],n=[],r=[],l={},d={},o={},h={};this.buffs.find(".active").each(function(){i.push($(this).attr("data-id"))}),this.filter.find(".sources .active").each(function(){n.push($(this).attr("data-id"))}),this.filter.find(".phases .active").each(function(){r.push($(this).attr("data-id"))});for(let e of talents){let t=[];for(let i of e.t)t.push(i.c);a.push({n:e.n,t:t})}s=spells;for(let e in gear){l[e]=[];for(let t of gear[e])l[e].push({id:t.id,selected:t.selected,dps:t.dps,hidden:t.hidden})}for(let e in enchant){d[e]=[];for(let t of enchant[e])d[e].push({id:t.id,selected:t.selected,dps:t.dps,hidden:t.hidden})}if("undefined"!=typeof runes)for(let e in runes){o[e]=[];for(let t of runes[e])o[e].push({id:t.id,selected:t.selected,hidden:t.hidden})}var c=["shadow","arcane","nature","fire","frost"];for(let e in c){var f=c[e];h[f]=$(".resistances[data-id='"+f+"-resist']").prop("checked")}t.buffs=i,t.rotation=s,t.sources=n,t.phases=r,t.talents=a,t.gear=l,t.enchant=d,t.runes=o,t.resistance=h,globalThis.profilename&&(t.profilename=globalThis.profilename);let u=globalThis.profileid||0;localStorage[mode+u]=JSON.stringify(t)},loadSession:function(){let e=globalThis.profileid||0;localStorage.level&&localStorage.clear(),localStorage[mode+e]||(localStorage[mode+e]=JSON.stringify(session)),"sod"==mode&&"4"!==localStorage.sodPatch&&(localStorage.sodPatch="4",localStorage.sod0=JSON.stringify(session));let t=JSON.parse(localStorage[mode+e]);t.level||(t.level=session.level),t.targetlevel||(t.targetlevel=session.targetlevel),t.profilename||(t.profilename=session.profilename),void 0===t.filter_strength&&(t.filter_strength=!0),void 0===t.filter_timeworn&&(t.filter_timeworn=!0),void 0===t.filter_bear&&(t.filter_bear=!0),void 0===t.filter_tiger&&(t.filter_tiger=!0),void 0===t.filter_green&&(t.filter_green=!0),void 0===t.filter_blue&&(t.filter_blue=!0),void 0===t.filter_epic&&(t.filter_epic=!0),globalThis.profilename=t.profilename,globalThis.filter_strength=t.filter_strength,globalThis.filter_bear=t.filter_bear,globalThis.filter_timeworn=t.filter_timeworn,globalThis.filter_tiger=t.filter_tiger,globalThis.filter_green=t.filter_green,globalThis.filter_blue=t.filter_blue,globalThis.filter_epic=t.filter_epic,3731!==t.targetbasearmor&&null!==t.targetbasearmor||(t.targetbasearmor=3128);for(let e in t)this.fight.find('input[name="'+e+'"]').val(t[e]),this.fight.find('select[name="'+e+'"]').val(t[e]),this.fight.find('.slider[name="slider-'+e+'"]').val(t[e]);this.sidebar.find(".bg").attr("data-race",this.fight.find('select[name="race"]').val());let i=$('select[name="targetbasearmor"]').get(0);t.targetcustomarmor?($('input[name="targetcustomarmor"]').addClass("focus"),i.options[i.options.length-1].innerHTML=""):($('input[name="targetcustomarmor"]').removeClass("focus"),i.options[i.options.length-1].innerHTML="Custom Value"),updateGlobals({talents:t.talents?t.talents:session.talents,buffs:t.buffs?t.buffs:session.buffs,rotation:t.rotation?t.rotation:session.rotation,gear:t.gear?t.gear:session.gear,enchant:t.enchant?t.enchant:session.enchant,runes:t.runes?t.runes:session.runes||{},resistances:t.resistances?t.resistances:null});let s=t.sources?t.sources:session.sources,a=t.phases?t.phases:session.phases;"sod"==mode&&(a=["1","2","3","4","5"]);for(let e of s)this.filter.find(`.sources [data-id="${e}"]`).addClass("active");for(let e of a)this.filter.find(`.phases [data-id="${e}"]`).addClass("active");var n=["shadow","arcane","nature","fire","frost"];for(let e in n){var r=n[e];$(".resistances[data-id='"+r+"-resist']").prop("checked")&&this.sidebar.find("."+r+"-resist.hidden").removeClass("hidden")}},filterGear:function(){var e=this.main.find("nav > ul > li.active").data("type");"mainhand"==e||"offhand"==e?this.loadWeapons(e):"custom"==e?this.loadCustom():this.loadGear(e)},loadWeapons:function(e,t){var i=this.main.find("nav li.active .filter .active").text();let s=JSON.parse(localStorage[mode+(globalThis.profileid||0)]),a=parseInt(s.level);SIM.UI.resistCheckList();let n=`<table class="gear ${t?"editmode":""}" data-type="${e}" data-max="1">\n                        <thead>\n                            <tr>\n                                ${t?"<th></th>":""}\n                                <th>ilvl</th>\n                                <th>Name</th>\n                                <th>Source</th>\n                                <th>Sta</th>\n                                <th>Res</th>\n                                <th>Str</th>\n                                <th>Agi</th>\n                                <th>AP</th>\n                                <th>ArP</th>\n                                <th>Crit</th>\n                                <th>Hit</th>\n                                <th>Haste</th>\n                                <th>Min</th>\n                                <th>Max</th>\n                                <th>Speed</th>\n                                <th>Skill</th>\n                                <th>Type</th>\n                                <th>PPM</th>\n                                <th>DPS</th>\n                            </tr>\n                        </thead>\n                    <tbody>`;for(let r of gear[e]){if(!r.selected&&(r.r>a||"sod"==mode&&r.q<3&&r.i<a-7||"sod"==mode&&3==r.q&&r.i<a-10||"sod"==mode&&4==r.q&&r.i<a-15))continue;if(!r.selected&&(!1===globalThis.filter_tiger&&r.name.toLowerCase().indexOf("of the tiger")>-1||!1===globalThis.filter_strength&&r.name.toLowerCase().indexOf("of strength")>-1||!1===globalThis.filter_bear&&r.name.toLowerCase().indexOf("of the bear")>-1||!1===globalThis.filter_green&&"2"==r.q||!1===globalThis.filter_blue&&"3"==r.q||!1===globalThis.filter_epic&&"4"==r.q||!1===globalThis.filter_timeworn&&r.tw)&&(!0!==globalThis.filter_timeworn||!r.tw))continue;if(i)if("All"==i){if("offhand"==e&&s.buffs.includes("71")){if("Shield"!==r.type)continue}else if("Shield"==r.type)continue}else if("Human Weps"==i){if("Mace"!=r.type&&"Sword"!=r.type)continue}else if("Goblin Weps"==i){if("Mace"!=r.type&&"Dagger"!=r.type)continue}else if("Edgies Weps"==i){if("Axe"!=r.type&&"Dagger"!=r.type&&"Sword"!=r.type)continue}else if(r.type!=i)continue;let l=(r.source||"").toLowerCase(),d=r.phase;if("Lethon"!=r.source&&"Emeriss"!=r.source&&"Kazzak"!=r.source&&"Azuregos"!=r.source&&"Ysondre"!=r.source&&"Taerar"!=r.source&&"Green Dragons"!=r.source&&"Nerubian"!=r.source&&"Dark Reaver"!=r.source&&"Concavius"!=r.source&&"Ostarius"!=r.source&&"Cla'ckora"!=r.source||(l="worldboss"),"shadow"!=r.subsource&&"arcane"!=r.subsource&&"nature"!=r.subsource&&"fire"!=r.subsource&&"frost"!=r.subsource||(l="resistances-list"),d&&!this.filter.find('.phases [data-id="'+d+'"]').hasClass("active"))continue;if(l&&!this.filter.find('.sources [data-id="'+l+'"]').hasClass("active"))continue;if("resistances-list"===l&&!$(".resistances[data-id='"+r.subsource+"-resist']").prop("checked"))continue;if(r.hidden&&!t)continue;let o=r.id.toString().split("|")[0],h="";199211==o&&(o=19921),23000399==o&&(o=230003),22839799==o&&(o=228397),22835099==o&&(o=228350),23024299==o&&(o=230242),r.rand&&(h="?rand="+r.rand);let c="";r.resist&&(r.resist.fire&&(c+=r.resist.fire+" FiR"),r.resist.frost&&(c+=(c.length?" + ":"")+r.resist.frost+" FR"),r.resist.nature&&(c+=(c.length?" + ":"")+r.resist.nature+" NR"),r.resist.shadow&&(c+=(c.length?" + ":"")+r.resist.shadow+" SR"),r.resist.arcane&&(c+=(c.length?" + ":"")+r.resist.arcane+" AR")),n+=`<tr data-id="${r.id}" data-name="${r.name}" class="${r.selected?"active":""} ${r.hidden?"hidden":""}">\n                        ${t?'<td class="hide">'+(r.hidden?eyesvghidden:eyesvg)+"</td>":""}\n                        <td data-quality="${r.q}"><a href="${WEB_DB_URL}item=${o}${h}"></a>${r.i||"?"}</td>\n                        <td>${r.name}</td>`,n+=`<td>${r.source||""}</td>\n                        <td>${r.sta||""}</td>\n                        <td>${c||""}</td>\n                        <td>${r.str||""}</td>\n                        <td>${r.agi||""}</td>\n                        <td>${r.ap||""}</td>\n                        <td>${r.arp||r.arpv||""}</td>\n                        <td>${r.crit||""}</td>\n                        <td>${r.hit||""}</td>\n                        <td>${r.haste||""}</td>\n                        <td>${r.mindmg||""}</td>\n                        <td>${r.maxdmg||""}</td>\n                        <td>${r.speed||""}</td>\n                        <td>${r.skill||r.skills&&Object.values(r.skills)[0]||""}</td>\n                        <td>${r.type||""}</td>\n                        <td class="ppm"><p contenteditable="true">${r.proc&&r.proc.ppm||""}</p></td>\n                        <td>${r.dps||""}</td>\n                    </tr>`}n+="</tbody></table></section>",this.tcontainer.empty(),this.tcontainer.append(`<div class="topgear">\n            <div class="search"><input name="search" placeholder="Search" />${searchSVG}</div>\n            <div class="filters">\n                <label style="display: none;" id="filter_timeworn" class="${globalThis.filter_timeworn?"active":""}">Timeworn</label>\n                <label style="display: none;" id="filter_strength" class="${globalThis.filter_strength?"active":""}">Of Strength</label>\n                <label style="display: none;" id="filter_bear" class="${globalThis.filter_bear?"active":""}">Of the Bear</label>\n                <label style="display: none;" id="filter_tiger" class="${globalThis.filter_tiger?"active":""}">Of the Tiger</label>\n                <label id="filter_green" class="${globalThis.filter_green?"active":""}">Greens</label>\n                <label id="filter_blue" class="${globalThis.filter_blue?"active":""}">Blues</label>\n                <label id="filter_epic" class="${globalThis.filter_epic?"active":""}">Epics</label>\n            </div>\n        </div>`),this.tcontainer.append(n);let r=this.tcontainer.find("table.gear th").length;this.tcontainer.find("table.gear").tablesorter({widthFixed:!1,sortList:t?[[r,1],[2,0]]:[[r-1,1],[1,0]],textSorter:{18:function(e,t,i,s,a){e=parseFloat(e.substring(0,e.indexOf(".")+3)),t=parseFloat(t.substring(0,t.indexOf(".")+3));return isNaN(e)&&(e=0),isNaN(t)&&(t=0),e<t?-1:e>t?1:0}},headers:{18:{sorter:"text"}}}),this.loadEnchants(e,t),this.updateSession()},resistCheckList:function(){return{shadow:$(".resistances[data-id='shadow-resist']").prop("checked"),arcane:$(".resistances[data-id='arcane-resist']").prop("checked"),nature:$(".resistances[data-id='nature-resist']").prop("checked"),fire:$(".resistances[data-id='fire-resist']").prop("checked"),frost:$(".resistances[data-id='frost-resist']").prop("checked")}},loadGear:function(e,t){if(!e)return;SIM.UI.resistCheckList();let i=JSON.parse(localStorage[mode+(globalThis.profileid||0)]),s=parseInt(i.level);let a=`<table class="gear ${t?"editmode":""}" data-type="${e}" data-max="1">\n                        <thead>\n                            <tr>\n                                ${t?"<th></th>":""}\n                                <th>ilvl</th>\n                                <th>Name</th>\n                                <th>Source</th>\n                                <th>Sta</th>\n                                <th>Res</th>\n                                <th>Str</th>\n                                <th>Agi</th>\n                                <th>AP</th>\n                                <th>ArP</th>\n                                <th>Hit</th>\n                                <th>Crit</th>\n                                <th>Haste</th>\n                                <th>Skill</th>\n                                <th>Type</th>\n                                <th>DPS</th>\n                            </tr>\n                        </thead>\n                    <tbody>`;for(let i of gear[e]){if(!i.selected&&(i.r>s||"sod"==mode&&i.q<3&&i.i<s-7||"sod"==mode&&3==i.q&&i.i<s-10||"sod"==mode&&4==i.q&&i.i<s-15))continue;if(!i.selected&&(!1===globalThis.filter_tiger&&i.name.toLowerCase().indexOf("of the tiger")>-1||!1===globalThis.filter_strength&&i.name.toLowerCase().indexOf("of strength")>-1||!1===globalThis.filter_bear&&i.name.toLowerCase().indexOf("of the bear")>-1||!1===globalThis.filter_green&&"2"==i.q||!1===globalThis.filter_blue&&"3"==i.q||!1===globalThis.filter_epic&&"4"==i.q||!1===globalThis.filter_timeworn&&i.tw)&&(!0!==globalThis.filter_timeworn||!i.tw))continue;let e=(i.source||"").toLowerCase(),n=i.phase;if("Lethon"!=i.source&&"Emeriss"!=i.source&&"Kazzak"!=i.source&&"Azuregos"!=i.source&&"Ysondre"!=i.source&&"Taerar"!=i.source&&"Green Dragons"!=i.source&&"Nerubian"!=i.source&&"Dark Reaver"!=i.source&&"Concavius"!=i.source&&"Ostarius"!=i.source&&"Cla'ckora"!=i.source||(e="worldboss"),"shadow"!=i.subsource&&"arcane"!=i.subsource&&"nature"!=i.subsource&&"fire"!=i.subsource&&"frost"!=i.subsource||(e="resistances-list"),n&&!this.filter.find('.phases [data-id="'+n+'"]').hasClass("active"))continue;if(e&&!this.filter.find('.sources [data-id="'+e+'"]').hasClass("active"))continue;if("resistances-list"===e&&!$(".resistances[data-id='"+i.subsource+"-resist']").prop("checked"))continue;if(i.hidden&&!t)continue;let r=i.id.toString().split("|")[0],l="";145541==r&&(r=14554),198981==r&&(r=19898),2207381==r&&(r=220738),i.rand&&(l="?rand="+i.rand);let d="";i.resist&&(i.resist.fire&&(d+=i.resist.fire+" FiR"),i.resist.frost&&(d+=(d.length?" + ":"")+i.resist.frost+" FR"),i.resist.nature&&(d+=(d.length?" + ":"")+i.resist.nature+" NR"),i.resist.shadow&&(d+=(d.length?" + ":"")+i.resist.shadow+" SR"),i.resist.arcane&&(d+=(d.length?" + ":"")+i.resist.arcane+" AR")),a+=`<tr data-id="${i.id}" class="${i.selected?"active":""} ${i.hidden?"hidden":""}">\n                        ${t?'<td class="hide">'+(i.hidden?eyesvghidden:eyesvg)+"</td>":""}\n                        <td data-quality="${i.q}"><a href="${WEB_DB_URL}item=${r}${l}"></a>${i.i||"?"}</td>\n                        <td>${i.name}</td>`,a+=`<td>${i.source||""}</td>\n                        <td>${i.sta||""}</td>\n                        <td>${d||""}</td>\n                        <td>${i.str||""}</td>\n                        <td>${i.agi||""}</td>\n                        <td>${i.ap||""}</td>\n                        <td>${i.arp||i.arpv||""}</td>\n                        <td>${i.hit||""}</td>\n                        <td>${i.crit||""}</td>\n                        <td>${i.haste||""}</td>\n                        <td>${i.skill||i.skills&&Object.values(i.skills)[0]||""}</td>\n                        <td>${i.type||""}</td>\n                        <td>${i.dps||""}</td>\n                    </tr>`}a+="</tbody></table></section>",this.tcontainer.empty(),this.loadRunes(e,t),this.tcontainer.append(`<div class="topgear">\n            <div class="search"><input name="search" placeholder="Search" />${searchSVG}</div>\n            <div class="filters">\n                <label style="display: none;" id="filter_timeworn" class="${globalThis.filter_timeworn?"active":""}">Timeworn</label>\n                <label style="display: none;" id="filter_strength" class="${globalThis.filter_strength?"active":""}">Of Strength</label>\n                <label style="display: none;" id="filter_bear" class="${globalThis.filter_bear?"active":""}">Of the Bear</label>\n                <label style="display: none;" id="filter_tiger" class="${globalThis.filter_tiger?"active":""}">Of the Tiger</label>\n                <label id="filter_green" class="${globalThis.filter_green?"active":""}">Greens</label>\n                <label id="filter_blue" class="${globalThis.filter_blue?"active":""}">Blues</label>\n                <label id="filter_epic" class="${globalThis.filter_epic?"active":""}">Epics</label>\n            </div>\n        </div>`),this.tcontainer.append(a);let n=this.tcontainer.find("table.gear th").length;this.tcontainer.find("table.gear").tablesorter({widthFixed:!1,sortList:t?[[n,1],[2,0]]:[[n-1,1],[1,0]],textSorter:{14:function(e,t,i,s,a){e=parseFloat(e.substring(0,e.indexOf(".")+3)),t=parseFloat(t.substring(0,t.indexOf(".")+3));return isNaN(e)&&(e=0),isNaN(t)&&(t=0),e<t?-1:e>t?1:0}},headers:{14:{sorter:"text"}}}),this.loadEnchants(e,t),this.updateSession(),this.updateSidebar()},loadCustom:function(e){SIM.UI.resistCheckList();let t=`<table class="gear ${e?"editmode":""}" data-type="custom" data-max="10">\n                        <thead>\n                            <tr>\n                                ${e?"<th></th>":""}\n                                <th>Name</th>\n                                <th>Str</th>\n                                <th>Agi</th>\n                                <th>AP</th>\n                                <th>ArP</th>\n                                <th>Hit</th>\n                                <th>Crit</th>\n                                <th>Haste</th>\n                                <th>Skill</th>\n                                <th>DPS</th>\n                            </tr>\n                        </thead>\n                    <tbody>`;for(let i of gear.custom){let s="";i.resist&&(i.resist.fire&&(s+=i.resist.fire+" FiR"),i.resist.frost&&(s+=(s.length?" + ":"")+i.resist.frost+" FR"),i.resist.nature&&(s+=(s.length?" + ":"")+i.resist.nature+" NR"),i.resist.shadow&&(s+=(s.length?" + ":"")+i.resist.shadow+" SR"),i.resist.arcane&&(s+=(s.length?" + ":"")+i.resist.arcane+" AR")),i.hidden&&!e||(t+=`<tr data-id="${i.id}" class="${i.selected?"active":""} ${i.hidden?"hidden":""}">\n                        ${e?'<td class="hide">'+(i.hidden?eyesvghidden:eyesvg)+"</td>":""}\n                        <td>${i.name}</td>\n                        <td>${i.str||""}</td>\n                        <td>${i.agi||""}</td>\n                        <td>${i.ap||""}</td>\n                        <td>${i.arp||""}</td>\n                        <td>${i.hit||""}</td>\n                        <td>${i.crit||""}</td>\n                        <td>${i.haste||""}</td>\n                        <td>${i.skill_1||""}</td>\n                        <td>${i.dps||""}</td>\n                    </tr>`)}t+="</tbody></table></section>",this.tcontainer.empty(),this.tcontainer.append(t),this.tcontainer.find("table.gear").tablesorter({widthFixed:!1,sortList:e?[[11,1]]:[[10,1]]})},loadEnchants:function(e,t){this.main.find(".js-enchant").hide();let i=JSON.parse(localStorage[mode+(globalThis.profileid||0)]),s=parseInt(i.level);if(!enchant[e]||0==enchant[e].length)return;SIM.UI.resistCheckList();let a=`<table class="enchant ${t?"editmode":""}" data-type="${e}" data-max="1">\n                        <thead>\n                            <tr>\n                                ${t?"<th></th>":""}\n                                <th>Enchant</th>\n                                <th>Res</th>\n                                <th>Damage</th>\n                                <th>Str</th>\n                                <th>Agi</th>\n                                <th>AP</th>\n                                <th>ArP</th>\n                                <th>Crit</th>\n                                <th>Hit</th>\n                                <th>Haste</th>\n                                <th>PPM</th>\n                                <th>DPS</th>\n                            </tr>\n                        </thead>\n                    <tbody>`;for(let i of enchant[e]){if(i.r>s){i.selected=!1;continue}if(i.phase&&!this.filter.find('.phases [data-id="'+i.phase+'"]').hasClass("active"))continue;if(i.hidden&&!t)continue;let e="";i.resist&&(i.resist.fire&&(e+=i.resist.fire+" FiR"),i.resist.frost&&(e+=(e.length?" + ":"")+i.resist.frost+" FR"),i.resist.nature&&(e+=(e.length?" + ":"")+i.resist.nature+" NR"),i.resist.shadow&&(e+=(e.length?" + ":"")+i.resist.shadow+" SR"),i.resist.arcane&&(e+=(e.length?" + ":"")+i.resist.arcane+" AR")),a+=`<tr data-id="${i.id}" data-temp="${i.temp||!1}" class="${i.selected?"active":""} ${i.hidden?"hidden":""}">\n                        ${t?'<td class="hide">'+(i.hidden?eyesvghidden:eyesvg)+"</td>":""}\n                        <td><a href="${WEB_DB_URL}${i.spellid?"spell":"item"}=${i.id}"></a>${i.name}</td>\n                        <td>${e||""}</td>\n                        <td>${i.bonusdmg||""}</td>\n                        <td>${i.str||""}</td>\n                        <td>${i.agi||""}</td>\n                        <td>${i.ap||""}</td>\n                        <td>${i.arp||""}</td>\n                        <td>${i.crit||""}</td>\n                        <td>${i.hit||""}</td>\n                        <td>${i.haste||""}</td>\n                        <td>${i.ppm||""}</td>\n                        <td>${i.dps||""}</td>\n                    </tr>`}a+="</tbody></table></section>",0!=$(a).find("tbody tr").length&&(this.tcontainer.append(a),this.tcontainer.find("table.enchant").tablesorter({widthFixed:!1,sortList:t?[[13,1]]:[[12,1]],headers:{12:{sorter:"text"}}}),this.main.find(".js-enchant").show())},loadRunes:function(e,t){if("undefined"==typeof runes||!runes[e]||0==runes[e].length)return;let i=$(`<div class="runes" data-type="${e}" style="display: none"></div>`);i.append("<label>Runes</label>");for(let t of runes[e])i.append(`\n                <div data-id="${t.id}" class="rune ${t.selected?"active":""}">\n                    <div class="icon">\n                        <img src="https://wow.zamimg.com/images/wow/icons/medium/${t.iconname}.jpg" alt="${t.name}">\n                        <a href="${WEB_DB_URL}spell=${t.id}" class="wh-tooltip"></a>\n                    </div>\n                </div>`);this.tcontainer.append(i)},addAlert:function(e){var t=this;let i=(65536*(1+Math.random())|0).toString(16).substring(1);t.alerts.empty().append(`<div id="alert${i}" class="alert"><p>${e}</p></div>`),t.alerts.find(".alert").click(function(){t.closeAlert(i)}),setTimeout(function(){t.alerts.find("#alert"+i).addClass("in-up")}),setTimeout(function(){t.closeAlert(i)},4e3)},closeAlert:function(e){var t=this;t.alerts.find("#alert"+e).removeClass("in-up"),setTimeout(function(){t.alerts.find("#alert"+e).remove()},1e3)},firstSession:function(){console.log("Welcome!")},initLog:function(){$(".modal").each(function(){dragElement($(this).get(0))}),$(".modal .btn-close").click(function(){$(".modal").hide()})}};var eyesvg='<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"><path d="M15 12c0 1.654-1.346 3-3 3s-3-1.346-3-3 1.346-3 3-3 3 1.346 3 3zm9-.449s-4.252 8.449-11.985 8.449c-7.18 0-12.015-8.449-12.015-8.449s4.446-7.551 12.015-7.551c7.694 0 11.985 7.551 11.985 7.551zm-7 .449c0-2.757-2.243-5-5-5s-5 2.243-5 5 2.243 5 5 5 5-2.243 5-5z"/></svg>',eyesvghidden='<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"><path d="M11.885 14.988l3.104-3.098.011.11c0 1.654-1.346 3-3 3l-.115-.012zm8.048-8.032l-3.274 3.268c.212.554.341 1.149.341 1.776 0 2.757-2.243 5-5 5-.631 0-1.229-.13-1.785-.344l-2.377 2.372c1.276.588 2.671.972 4.177.972 7.733 0 11.985-8.449 11.985-8.449s-1.415-2.478-4.067-4.595zm1.431-3.536l-18.619 18.58-1.382-1.422 3.455-3.447c-3.022-2.45-4.818-5.58-4.818-5.58s4.446-7.551 12.015-7.551c1.825 0 3.456.426 4.886 1.075l3.081-3.075 1.382 1.42zm-13.751 10.922l1.519-1.515c-.077-.264-.132-.538-.132-.827 0-1.654 1.346-3 3-3 .291 0 .567.055.833.134l1.518-1.515c-.704-.382-1.496-.619-2.351-.619-2.757 0-5 2.243-5 5 0 .852.235 1.641.613 2.342z"/></svg>',searchSVG='<svg xmlns="http://www.w3.org/2000/svg"  viewBox="0 0 50 50" width="20px" height="20px"><path d="M 21 3 C 11.621094 3 4 10.621094 4 20 C 4 29.378906 11.621094 37 21 37 C 24.710938 37 28.140625 35.804688 30.9375 33.78125 L 44.09375 46.90625 L 46.90625 44.09375 L 33.90625 31.0625 C 36.460938 28.085938 38 24.222656 38 20 C 38 10.621094 30.378906 3 21 3 Z M 21 5 C 29.296875 5 36 11.703125 36 20 C 36 28.296875 29.296875 35 21 35 C 12.703125 35 6 28.296875 6 20 C 6 11.703125 12.703125 5 21 5 Z"/></svg>';function dragElement(e){var t=0,i=0,s=0,a=0;function n(e){(e=e||window.event).preventDefault(),s=e.clientX,a=e.clientY,document.onmouseup=l,document.onmousemove=r}function r(n){(n=n||window.event).preventDefault(),t=s-n.clientX,i=a-n.clientY,s=n.clientX,a=n.clientY,e.style.top=e.offsetTop-i+"px",e.style.left=e.offsetLeft-t+"px"}function l(){document.onmouseup=null,document.onmousemove=null}e.querySelector(".head")?e.querySelector(".head").onmousedown=n:e.onmousedown=n}